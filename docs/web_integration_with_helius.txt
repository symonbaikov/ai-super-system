–ü–æ—Å–ª–µ–¥–Ω–∏–π 111. –° –•–µ–ª–∏—É—Å PR –∏ –¢—Ä–µ–π–¥–∏–Ω–≥ –≤—å—é 29.09 


import React, { useMemo, useRef, useState, useEffect, useContext, createContext } from "react";
import { LineChart, Line, Tooltip, ResponsiveContainer, XAxis, YAxis, ReferenceArea, CartesianGrid } from "recharts";

// ‚ú¶ Alpha2 Super Parser ‚Äî UI 18.09 (+ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è 29.09) ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å—É–ø–µ—Ä-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
// –í–ê–ñ–ù–û: —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–µ –ª–æ–º–∞–ª, —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏–ª/–ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–∏–ª —Ç–æ, —á—Ç–æ —Ç—ã –ø–æ–ø—Ä–æ—Å–∏–ª.
// –ù–æ–≤–æ–µ:
// 1) –°–∏–≥–Ω–∞–ª—ã: –≤ –Ω–∏–∂–Ω–µ–º –±–æ–ª—å—à–æ–º –æ–∫–Ω–µ —Ç–µ–ø–µ—Ä—å —Å–ø–∏—Å–æ–∫ –û–ß–ò–©–ï–ù–ù–´–• —Ö–∞–π–ø-—Å–ª–æ–≤ (—Å–ª–æ–≤–æ, –∫—Ç–æ —Å–∫–∞–∑–∞–ª [—Å—Å—ã–ª–∫–∞], –¥–∞—Ç–∞/–≤—Ä–µ–º—è, –∏—Å—Ç–æ—á–Ω–∏–∫ TG/Twitter).
// 2) –ê–∫–∫–∞—É–Ω—Ç—ã: –∑–∞–≥—Ä—É–∑–∫–∞ Tw/TG –∞–∫–∫–∞—É–Ω—Ç–æ–≤, –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª, –≤—ã–±–æ—Ä –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (5/15/30/60 –º–∏–Ω), –º–µ–Ω–µ–¥–∂–µ—Ä API-–∫–ª—é—á–µ–π (–¥–æ–±–∞–≤–ª–µ–Ω—ã 5 –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ+–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä/–ª–æ–≥–∏).
// 3) –£–±—Ä–∞–Ω –±–ª–æ–∫ –∫–ª—é—á–µ–π —Å–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü ‚Äî –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¢–û–õ–¨–ö–û –Ω–∞ –≤–∫–ª–∞–¥–∫–µ ¬´–ê–∫–∫–∞—É–Ω—Ç—ã¬ª.
// 4) Tradeview: —Ä–µ–∂–∏–º –Ω–∞–ª–æ–∂–µ–Ω–∏–π BUY/SELL/WHALE/HYPE –æ—Å—Ç–∞—ë—Ç—Å—è ¬´–Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–Ω—ã–º —É –Ω–∞—Å¬ª, –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω –∫–∏—Ç–∞ (–æ—Ç‚Ä¶–¥–æ SOL).
// 5) Helius: —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø, —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö –º–∏–Ω—Ç–æ–≤ (—Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –¥–µ–º–æ), —Å –∏–Ω—Ñ–æ –∏ –∫–Ω–æ–ø–∫–æ–π ¬´–°–∫–∞—á–∞—Ç—å –º–∏–Ω—Ç¬ª.
// 6) CEX Radar: —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø, –ø–æ–∏—Å–∫, —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–≤—ã—Ö –ª–∏—Å—Ç–∏–Ω–≥–æ–≤ –∏ –∫–Ω–æ–ø–∫–∞ ¬´–û—Ç–∫—Ä—ã—Ç—å¬ª (—Å—Å—ã–ª–∫–∞ –Ω–∞ Birdeye).
// 7) –£—á–∏—Ç—å—Å—è: –∑–∞–≥—Ä—É–∑–∫–∞ –∫–Ω–∏–≥, –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª, —Ç–æ–Ω–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, –≥—Ä–∞—Ñ–∏–∫–æ–≤/—Ñ–æ—Ç–æ.

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ helpers
const cls = (...a) => a.filter(Boolean).join(" ");
const pretty = (v) => (v===0?0:(v|| "‚Äî"));
const download = (name, text, mime) => { const blob = new Blob([text], {type: mime||"text/plain"}); const url = URL.createObjectURL(blob); const a=document.createElement("a"); a.href=url; a.download=name; a.click(); URL.revokeObjectURL(url); };
const loadLS = (k, d) => { try{ const v = localStorage.getItem(k); return v? JSON.parse(v): d; }catch{return d;} };
const saveLS = (k, v) => { try{ localStorage.setItem(k, JSON.stringify(v)); }catch{} };
const uid = () => Math.random().toString(36).slice(2,9);

// —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —É–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–≤ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ –ø–∞–Ω–µ–ª–∏ ¬´–æ—á–∏—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞¬ª)
function uniqueHypeWords(rows){
  const map = new Map();
  rows.forEach(r=>{
    const key = (r.word||"").trim().toUpperCase();
    if(!key) return;
    const cur = map.get(key);
    if(!cur || (r.detectedAt||"") > (cur.ts||"")){
      map.set(key, { word:r.word, author:r.author, link:r.link, ts:r.detectedAt, src:r.source });
    }
  });
  return Array.from(map.values()).sort((a,b)=> (b.ts||"").localeCompare(a.ts||""));
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ mini UI kit
const Card = ({className, ...p}) => <div className={cls("rounded-2xl border border-zinc-800 bg-zinc-950", className)} {...p}/>;
const CardHeader = ({className, right, children, ...p}) => <div className={cls("px-4 py-3 border-b border-zinc-800 flex items-center justify-between", className)} {...p}><div>{children}</div>{right}</div>;
const CardTitle = ({className, ...p}) => <div className={cls("text-sm font-semibold", className)} {...p}/>;
const CardContent = ({className, ...p}) => <div className={cls("p-4", className)} {...p}/>;
const Button = ({variant="solid", size="md", className, ...p}) => (
  <button
    className={cls(
      "inline-flex items-center justify-center rounded-lg transition-colors",
      size==="sm"?"h-8 px-3 text-sm":"h-10 px-4 text-sm",
      variant==="ghost"?"bg-transparent border border-zinc-700 hover:bg-zinc-900":
      variant==="danger"?"bg-red-600 hover:bg-red-500":
      variant==="success"?"bg-emerald-600 hover:bg-emerald-500":"bg-zinc-800 hover:bg-zinc-700",
      className
    )}
    {...p}
  />
);
const Input = React.forwardRef((props, ref)=> (
  <input ref={ref} {...props} className={cls("h-10 w-full rounded-lg border border-zinc-800 bg-zinc-900 px-3 text-sm outline-none focus:ring-1 focus:ring-zinc-600", props.className)}/>
));
const NumberInput = (props)=> <Input type="number" {...props}/>;
const Textarea = React.forwardRef((props, ref)=> (
  <textarea ref={ref} {...props} className={cls("min-h-[120px] w-full rounded-lg border border-zinc-800 bg-zinc-900 px-3 py-2 text-sm outline-none focus:ring-1 focus:ring-zinc-600", props.className)}/>
));
const Label = (p)=> <label className={cls("text-xs text-zinc-400", p.className)} {...p}/>;
const Led = ({ok, className}) => <span title={ok?"–∞–∫—Ç–∏–≤–µ–Ω":"–æ—à–∏–±–∫–∞"} className={cls("inline-block w-2.5 h-2.5 rounded-full", ok?"bg-emerald-500":"bg-red-600", className)} />
const Badge = ({children, tone="default", className}) => (
  <span className={cls("inline-flex items-center rounded-md px-2 py-0.5 text-[11px] font-medium", tone==="ok"?"bg-emerald-700 text-white":tone==="warn"?"bg-amber-700 text-white":tone==="bad"?"bg-red-700 text-white":"bg-zinc-800 text-white", className)}>{children}</span>
);

// Table (–≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ; –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
const Table = ({columns, data, onRowClick, emptyText}) => (
  <div className="w-full overflow-auto rounded-xl border border-zinc-800">
    <table className="w-full text-left text-sm text-white">
      <thead className="bg-zinc-900/60"><tr>{columns.map(c=> <th key={c.key} className="px-4 py-3 font-medium whitespace-nowrap">{c.title}</th>)}</tr></thead>
      <tbody>
        {(!data||data.length===0)&&(<tr><td colSpan={columns.length} className="px-4 py-10 text-center text-zinc-500">{emptyText||"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}</td></tr>)}
        {data?.map((row,i)=> (
          <tr key={row.id||i} className="border-t border-zinc-800/80 hover:bg-zinc-900/40" onClick={()=>onRowClick?.(row)}>
            {columns.map(c=> <td key={c.key} className="px-4 py-3 align-top">{c.render? c.render(row): row[c.key]}</td>)}
          </tr>
        ))}
      </tbody>
    </table>
  </div>
);

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ demo data
const seedSignals = [
  { id:"1", word:"Dark MAGA", isOG:true, type:"—Å–ª–æ–≤–æ", detectedAt:"2025-09-17 11:24", source:"Twitter", author:"@elonmusk", link:"https://x.com/search?q=Dark%20MAGA", image:"", tweetCount:842, communitySize:125000, nameChanges:0, spamScore:0.08, devTeam:null, communityLink:"https://t.me/example", contract:"", chain:"Solana", safety:{noMint:true,burnLP:true,blacklist:false}, summary:"–¢—Ä–µ–Ω–¥–æ–≤–∞—è —Ñ—Ä–∞–∑–∞ ‚Äî –≤—ã—Å–æ–∫–∏–π —à–∞–Ω—Å –∫–ª–æ–Ω–æ–≤. OG –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω." },
  { id:"2", word:"STEVE", isOG:false, type:"—Ç–æ–∫–µ–Ω", detectedAt:"2025-09-17 12:03", source:"Telegram", author:"@memelabs", link:"https://t.me/memelabs/42", image:"", tweetCount:120, communitySize:21000, nameChanges:2, spamScore:0.42, devTeam:"unknown", communityLink:"https://x.com/search?q=STEVE", contract:"So1xxxx...abcd", chain:"Solana", safety:{noMint:false,burnLP:false,blacklist:true}, summary:"–ú–Ω–æ–≥–æ –∫–ª–æ–Ω–æ–≤, –≤—ã—Å–æ–∫–∏–π —Å–ø–∞–º-–∏–Ω–¥–µ–∫—Å. –í–µ—Ä–æ—è—Ç–µ–Ω –±—ã—Å—Ç—Ä—ã–π –ø–∞–º–ø/–¥–∞–º–ø." }
];
function genSeries(n=180, base=1){ const out=[]; let v=base; for(let i=0;i<n;i++){ v = Math.max(0.1, v + (Math.random()-0.5)*0.03); out.push({i, v: +v.toFixed(4)});} return out; }

export default function App(){
  const [tab, setTab] = useState("signals");

  // –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  const [running, setRunning] = useState(false);
  const [logs, setLogs] = useState([]);
  const log = (msg)=> setLogs(x=> [...x, {ts:new Date().toISOString(), msg}]);

  // –∫–ª—é—á–∏ ‚Äî —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –Ω–∞ ¬´–ê–∫–∫–∞—É–Ω—Ç—ã¬ª
  const [keys,setKeys]=useState(loadLS("keys", {
    groq:"", apify:"", twitterBearer:"", helius:"", quicknode:"", pumpfun:"", nansen:"",
    solscan:"", birdeye:"", gmgn:"", solsniffer:"", rugcheck:""
  }));
  const [keyStatus,setKeyStatus]=useState(loadLS("keyStatus", {}));
  useEffect(()=> saveLS("keys", keys), [keys]);
  useEffect(()=> saveLS("keyStatus", keyStatus), [keyStatus]);
  const saveKey=(k)=>{
    const ok = !!(keys[k] && String(keys[k]).trim());
    setKeyStatus(s=>({...s, [k]: ok?"ok":"error"}));
    if(!ok) log(`[keys] –ü—É—Å—Ç–æ–π –∫–ª—é—á: ${k}`); else log(`[keys] –°–æ—Ö—Ä–∞–Ω—ë–Ω –∫–ª—é—á: ${k}`);
  };

  // —Å–∏–≥–Ω–∞–ª—ã
  const [rows, setRows] = useState(seedSignals);
  const [query, setQuery] = useState("");
  const [onlyOG, setOnlyOG] = useState(true);
  const [cadenceMin, setCadenceMin] = useState(5); // —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤–∫–ª–∞–¥–∫–æ–π ¬´–ê–∫–∫–∞—É–Ω—Ç—ã¬ª

  // –∞–ª–µ—Ä—Ç—ã
  const [alerts, setAlerts] = useState(loadLS("alerts", []));
  const unread = alerts.filter(a=>!a.read).length;
  useEffect(()=> saveLS("alerts", alerts), [alerts]);

  // —Å—Ç–∞—Ç—É—Å—ã
  const [statusLine, setStatusLine] = useState({helius:"‚Äî", signals:"‚Äî", filters:"#sol #new #pump", ai:"–≤—Ö–æ–¥ –º–∞–ª—ã–º, SL 20%"});
  useEffect(()=>{
    const i = setInterval(()=>{
      const a = ["swap +$"+(1000+Math.random()*9000).toFixed(0), `liq ${Math.random()>0.5?"+":"-"}${(5+Math.random()*20).toFixed(0)}%/10m`];
      const s = ["Pump‚Üë","Spread‚Üì","Vol‚Üë"][Math.floor(Math.random()*3)];
      setStatusLine(v=>({...v, helius: a.join(", "), signals: s }));
    }, 3000);
    return ()=>clearInterval(i);
  },[]);

  // Helius AR (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º)
  const [arText, setArText] = useState("");
  const [arRunning, setArRunning] = useState(false);
  const [arTimer, setArTimer] = useState(null);
  const [arRows, setArRows] = useState([]);
  const startHeliusAR=()=>{
    const list = parseTickers(arText);
    if(!list.length){ alert("–î–æ–±–∞–≤—å—Ç–µ —Ç–∏–∫–µ—Ä—ã (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)"); return; }
    setArRunning(true);
    const id = setInterval(()=>{
      const t = list[Math.floor(Math.random()*list.length)];
      const addr = `So1${uid()}${uid()}`.slice(0,16)+"...";
      const now = new Date().toISOString().replace("T"," ").slice(0,19);
      const row = { id: uid(), name: t.startsWith("$")? t : `$${t}`, mint: addr, team: ["anon","doxxed","unknown"][Math.floor(Math.random()*3)], source: "Helius/DAS", original: "yes", ts: now };
      setArRows(rs=> [row, ...rs].slice(0,200));
      setAlerts(a=> [{ts:new Date().toISOString(), type:"mint", asset: row.name, msg:`–ù–∞–π–¥–µ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–∏–Ω—Ç ${row.mint}`}, ...a].slice(0,200));
    }, 4000 + Math.random()*3000);
    setArTimer(id);
  };
  const stopHeliusAR=()=>{ setArRunning(false); if(arTimer){ clearInterval(arTimer); setArTimer(null);} };
  const parseTickers=(t)=> Array.from(new Set((t||"").replace(/\$/g, "").replace(/[\,\;]+/g, "\n").split(/\n+/).map(s=>s.trim()).filter(Boolean))).slice(0,200);

  // Tradeview
  const [tradeQuery, setTradeQuery] = useState("");
  const [chartData, setChartData] = useState(genSeries());
  const [overlayEvents, setOverlayEvents] = useState([]);
  const [reasons, setReasons] = useState([]);
  // –¥–∏–∞–ø–∞–∑–æ–Ω –∫–∏—Ç–∞
  const [whaleMin, setWhaleMin] = useState(loadLS("whaleMin", 3));
  const [whaleMax, setWhaleMax] = useState(loadLS("whaleMax", 19));
  const [winSec, setWinSec] = useState(loadLS("winSec", 10));
  const [aggr, setAggr] = useState(loadLS("aggr", false));
  useEffect(()=>{ saveLS("whaleMin", whaleMin); saveLS("whaleMax", whaleMax); saveLS("winSec", winSec); saveLS("aggr", aggr); },[whaleMin,whaleMax,winSec,aggr]);
  const [hypeMetrics, setHypeMetrics] = useState({tw1h:0, tw3h:0, tg1h:0, tg3h:0});
  useEffect(()=>{
    const id = setInterval(()=>{
      setChartData(prev=>{ const last = prev[prev.length-1]?.v ?? 1; const next = Math.max(0.1, last + (Math.random()-0.5)*0.02); const i = (prev[prev.length-1]?.i ?? 0)+1; return [...prev.slice(-179), {i, v:+next.toFixed(4)}]; });
      if(Math.random()>0.92){ const i = chartData[chartData.length-1]?.i ?? 0; const t = Math.random(); const add=(type,color)=> setOverlayEvents(ev=>[...ev, {i,type,color,id:uid()}].slice(-200));
        if(t>0.66) add('BUY','#16a34a'); else if(t>0.33) add('SELL','#dc2626'); else add('WHALE','#60a5fa'); if(Math.random()>0.5) add('HYPE','#eab308');
        setReasons(makeReasons([...overlayEvents])); setHypeMetrics(h=>({ tw1h: Math.min(9999, h.tw1h + Math.floor(10+Math.random()*30)), tw3h: Math.min(99999, h.tw3h + Math.floor(30+Math.random()*90)), tg1h: Math.min(9999, h.tg1h + Math.floor(5+Math.random()*20)), tg3h: Math.min(99999, h.tg3h + Math.floor(20+Math.random()*60)), })); }
    }, 1200);
    return ()=>clearInterval(id);
  },[chartData, overlayEvents]);
  const makeReasons=(ev)=> ev.slice(-6).reverse().map(e=>{
    if(e.type==='BUY') return `BUY: ‚â•3 —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∑–µ–ª—ë–Ω—ã–µ; AVWAP –Ω–∞–¥ —Ü–µ–Ω–æ–π; –≤—Å–ø–ª–µ—Å–∫ –æ–±—ä—ë–º–∞; –∫–∏—Ç—ã IN –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ ${whaleMin}‚Äì${whaleMax} SOL –∑–∞ ${winSec}s${aggr?" (Aggressive)":""}.`;
    if(e.type==='SELL') return `SELL: –ø–æ—Ç–µ—Ä—è AVWAP; RSI-—Å–ª–æ–º; Whales OUT; –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –¥–µ–ª—å—Ç–∞ –æ–±—ä—ë–º–∞.`;
    if(e.type==='WHALE') return `Whale IN: ‚â•2 –∫–æ—à–µ–ª—å–∫–æ–≤ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ ${whaleMin}‚Äì${whaleMax} SOL / ${winSec}s${aggr?" (Aggressive: 1 –∫–æ—à–µ–ª—ë–∫ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è)":""}.`;
    if(e.type==='HYPE') return `HYPE: —Ä–æ—Å—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π Twitter/Telegram (1h/3h).`;
    return `${e.type}`;
  });
  const onSignals=()=>{ const base = genSeries(); setChartData(base); const ov = [ {i:20,type:'BUY',color:'#16a34a',id:uid()}, {i:60,type:'WHALE',color:'#60a5fa',id:uid()}, {i:110,type:'HYPE',color:'#eab308',id:uid()}, {i:150,type:'SELL',color:'#dc2626',id:uid()} ]; setOverlayEvents(ov); setReasons(makeReasons(ov)); };

  // Helius ‚Äî –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –º–∏–Ω—Ç–æ–≤
  const [helRunning, setHelRunning] = useState(false);
  const [helTimer, setHelTimer] = useState(null);
  const [helRows, setHelRows] = useState([]); // {name, mint, sol, safe, original, hasTw, team}
  const startHel=()=>{
    setHelRunning(true);
    const id = setInterval(()=>{
      const r = { id:uid(), name:`$${["DOGE","PEPE","TRUMP","CAT","WATER"][Math.floor(Math.random()*5)]}${Math.floor(Math.random()*100)}`, mint:`So1${uid()}${uid()}`.slice(0,16)+"...", sol: +(Math.random()*20+1).toFixed(2), safe: true, original: Math.random()>0.4, hasTw: Math.random()>0.5, team:["anon","doxxed","unknown"][Math.floor(Math.random()*3)], ts: new Date().toISOString().replace("T"," ").slice(0,19) };
      setHelRows(x=> [r, ...x].slice(0,200));
    }, 3500);
    setHelTimer(id);
  };
  const stopHel=()=>{ setHelRunning(false); if(helTimer){ clearInterval(helTimer); setHelTimer(null);} };

  // CEX Radar
  const [cexRunning, setCexRunning] = useState(false);
  const [cexQuery, setCexQuery] = useState("");
  const [cexRows, setCexRows] = useState([]);
  const cexSearch=()=>{
    const token = cexQuery || "TOKEN";
    const mk = (ex,mins)=>({ exchange:ex, date:new Date(Date.now()+mins*60000).toISOString().slice(0,10), time:new Date(Date.now()+mins*60000).toISOString().slice(11,19), team:["anon","doxxed","unknown"][Math.floor(Math.random()*3)], first:true, url:`https://birdeye.so/token/${encodeURIComponent(token)}?chain=solana` });
    setCexRows([mk("Binance",15), mk("OKX",30), mk("Bybit",45), mk("MEXC",60)]);
  };

  // –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
  const columnsSignals=[
    { key:"word", title:"–ù–∞–∑–≤–∞–Ω–∏–µ / —Å–ª–æ–≤–æ", render:(r)=> (
      <div className="flex items-center gap-3">
        <div className="size-9 rounded-lg bg-zinc-800"/>
        <div>
          <div className="font-medium">{r.word}</div>
          <div className="text-[11px] text-zinc-500">{r.type} ¬∑ {r.chain||"-"}</div>
        </div>
        <Badge tone={r.isOG?"ok":""} className="ml-2">{r.isOG?"OG":"Clone"}</Badge>
      </div>
    )},
    { key:"detectedAt", title:"–î–∞—Ç–∞/–≤—Ä–µ–º—è" },
    { key:"author", title:"–ê–≤—Ç–æ—Ä", render:(r)=> <a className="text-sky-300" href={r.link} target="_blank" rel="noreferrer">{r.author}</a> },
    { key:"metrics", title:"–ú–µ—Ç—Ä–∏–∫–∏", render:(r)=> <div className="text-xs text-zinc-300 leading-5">–¢–≤–∏—Ç–æ–≤: <b>{r.tweetCount??"-"}</b><br/>–ö–æ–º—å—é–Ω–∏—Ç–∏: <b>{r.communitySize??"-"}</b><br/>–°–º–µ–Ω –Ω–∞–∑–≤–∞–Ω–∏—è: <b>{r.nameChanges??0}</b> ¬∑ –°–ø–∞–º: <b>{Math.round((r.spamScore??0)*100)}%</b></div> },
    { key:"safety", title:"–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", render:(r)=> <div className="text-xs"><Badge className="mr-1" tone={r.safety?.noMint?"ok":""}>no mint</Badge><Badge className="mr-1" tone={r.safety?.burnLP?"ok":""}>burn LP</Badge><Badge className="mr-1" tone={!r.safety?.blacklist?"ok":"bad"}>{r.safety?.blacklist?"blacklist":"ok"}</Badge></div> },
    { key:"contract", title:"–ö–æ–Ω—Ç—Ä–∞–∫—Ç / —Å—Å—ã–ª–∫–∏", render:(r)=> <div className="text-xs"><div className="font-mono">{pretty(r.contract)}</div>{r.communityLink&& <div className="mt-1"><a className="text-sky-300" href={r.communityLink} target="_blank" rel="noreferrer">–ö–æ–º—å—é–Ω–∏—Ç–∏</a></div>}</div> },
    { key:"summary", title:"–†–µ–∑—é–º–µ" }
  ];

  // –ø–∞–Ω–µ–ª—å –æ—á–∏—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤ (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞, —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å hypeMetrics)
  const hypeWords = useMemo(()=> uniqueHypeWords(rows.filter(r=> (!onlyOG||r.isOG) && (!query || (`${r.word} ${r.author} ${r.contract||""}`.toLowerCase().includes(query.toLowerCase()))))), [rows,onlyOG,query]);

  // ======= –í–ö–õ–ê–î–ö–ò =======
  const Signals = (
    <Card>
      <CardHeader><CardTitle>–ü–æ—Ç–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤</CardTitle></CardHeader>
      <CardContent>
        <div className="mb-4 flex flex-col md:flex-row md:items-center gap-3">
          <div className="flex-1"><Input placeholder="–ü–æ–∏—Å–∫: —Å–ª–æ–≤–æ, –∞–≤—Ç–æ—Ä, –∫–æ–Ω—Ç—Ä–∞–∫—Ç" value={query} onChange={e=>setQuery(e.target.value)}/></div>
          <div className="flex items-center gap-2 text-sm"><input type="checkbox" checked={onlyOG} onChange={e=>setOnlyOG(e.target.checked)}/><span>–¢–æ–ª—å–∫–æ OG</span></div>
          <div className="text-xs text-zinc-500">–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø–∞—Ä—Å–∏–Ω–≥–∞: <b>{cadenceMin} –º–∏–Ω</b> (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤–æ –≤–∫–ª–∞–¥–∫–µ ¬´–ê–∫–∫–∞—É–Ω—Ç—ã¬ª)</div>
        </div>
        <Table columns={columnsSignals} data={rows.filter(r=> (!onlyOG||r.isOG) && (!query || (`${r.word} ${r.author} ${r.summary||""} ${r.contract||""}`.toLowerCase().includes(query.toLowerCase()))))} emptyText="–ù–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–≤. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–µ—Ä –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ JSON."/>

        {/* –ù–∏–∂–Ω—è—è –±–æ–ª—å—à–∞—è –ø–∞–Ω–µ–ª—å ‚Äî —Ç–æ–ª—å–∫–æ –æ—á–∏—â–µ–Ω–Ω—ã–µ —Ö–∞–π–ø-—Å–ª–æ–≤–∞ */}
        <div className="mt-4 rounded-xl border border-zinc-800 bg-zinc-900/40 p-4">
          <div className="text-sm font-semibold mb-2">–û—á–∏—â–µ–Ω–Ω—ã–µ —Ö–∞–π–ø-—Å–ª–æ–≤–∞</div>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
            {hypeWords.length? hypeWords.map((h,i)=>(
              <div key={(h.word||"")+i} className="rounded-lg border border-zinc-800 p-3 text-sm">
                <div className="font-medium">{h.word}</div>
                <div className="text-xs text-zinc-400 mt-1 flex items-center gap-2">
                  <a className="text-sky-300" href={h.link} target="_blank" rel="noreferrer">{h.author}</a>
                  <span>¬∑ {h.ts}</span>
                  <Badge>{h.src}</Badge>
                </div>
              </div>
            )): <div className="text-zinc-500">–ü–æ–∫–∞ –Ω–µ—Ç –æ—á–∏—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤ ‚Äî –¥–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.</div>}
          </div>
        </div>
      </CardContent>
    </Card>
  );

  const Accounts = (
    <Card>
      <CardHeader right={<div className="flex items-center gap-2 text-sm"><Badge tone="warn">–¢–æ–ª—å–∫–æ –¥–ª—è –°–∏–≥–Ω–∞–ª—ã</Badge></div>}>
        <CardTitle>–ê–∫–∫–∞—É–Ω—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞</CardTitle>
      </CardHeader>
      <CardContent>
        {/* –ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ */}
        <div className="grid md:grid-cols-2 gap-4">
          <div>
            <Label>–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã Twitter (CSV/JSON, –ø–æ @handle)</Label>
            <Input type="file" accept=".csv,application/json" onChange={async (e)=>{ const f=e.target.files?.[0]; if(!f) return; const txt=await f.text(); let list=[]; try{ list=JSON.parse(txt); if(!Array.isArray(list)) list=[]; }catch{ list = txt.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);} log(`[accounts] Twitter +${list.length}`); }} />
          </div>
          <div>
            <Label>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≥—Ä—É–ø–ø—ã Telegram (CSV/JSON, –ø–æ —Å—Å—ã–ª–∫–∞–º)</Label>
            <Input type="file" accept=".csv,application/json" onChange={async (e)=>{ const f=e.target.files?.[0]; if(!f) return; const txt=await f.text(); let list=[]; try{ list=JSON.parse(txt); if(!Array.isArray(list)) list=[]; }catch{ list = txt.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);} log(`[accounts] Telegram +${list.length}`); }} />
          </div>
        </div>

        {/* –ü—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ */}
        <div className="mt-4">
          <Label>–ü—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (JSON) ‚Äî Twitter/TG</Label>
          <Input type="file" accept="application/json" onChange={async (e)=>{ const f=e.target.files?.[0]; if(!f) return; const txt=await f.text(); try{ JSON.parse(txt); log(`[rules] –ó–∞–≥—Ä—É–∂–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ (${f.name})`);}catch{ log(`[rules] –û—à–∏–±–∫–∞ JSON –≤ ${f.name}`);} }} />
        </div>

        {/* –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø–∞—Ä—Å–∏–Ω–≥–∞ */}
        <div className="mt-4 grid grid-cols-2 md:grid-cols-4 gap-3">
          {[5,15,30,60].map(v=> (
            <Button key={v} variant={cadenceMin===v?"success":"ghost"} onClick={()=>{ setCadenceMin(v); log(`[cadence] ${v} –º–∏–Ω`); }}>{v} –º–∏–Ω</Button>
          ))}
        </div>

        {/* –ú–µ–Ω–µ–¥–∂–µ—Ä API-–∫–ª—é—á–µ–π */}
        <div className="mt-6">
          <div className="text-sm font-semibold mb-2">API –∫–ª—é—á–∏</div>
          <div className="grid md:grid-cols-2 gap-3">
            {Object.keys(keys).map(k=> (
              <div key={k} className="flex items-center gap-2">
                <Label className="w-32 capitalize">{k}</Label>
                <Input type="password" placeholder={`–∫–ª—é—á ${k}`} value={keys[k]} onChange={e=>setKeys({...keys, [k]: e.target.value})}/>
                <Button size="sm" onClick={()=>saveKey(k)}>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</Button>
                <Led ok={keyStatus[k]==='ok'} />
              </div>
            ))}
          </div>
          <div className="text-xs text-zinc-500 mt-1">–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–µ–ª—ë–Ω—ã–π ‚Äî –∫–ª—é—á –∞–∫—Ç–∏–≤–µ–Ω; –∫—Ä–∞—Å–Ω—ã–π ‚Äî –æ—à–∏–±–∫–∞ (–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º. ¬´–õ–æ–≥–∏¬ª).</div>
        </div>
      </CardContent>
    </Card>
  );

  const HeliusAR = (
    <Card>
      <CardHeader right={<div className="flex items-center gap-2">{arRunning? <Badge tone="ok">–†–∞–±–æ—Ç–∞–µ—Ç</Badge>: <Badge tone="bad">–°—Ç–æ–ø</Badge>}<Button onClick={startHeliusAR}>–ü–æ–∏—Å–∫</Button><Button variant="ghost" onClick={stopHeliusAR}>–°—Ç–æ–ø</Button></div>}>
        <CardTitle>Helius AR ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±—É–¥—É—â–∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
          <div className="md:col-span-2">
            <Label>–°–ø–∏—Å–æ–∫ —Ç–∏–∫–µ—Ä–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</Label>
            <Textarea placeholder={`$TRUMP\n$PEPE\n$DOGE ...`} value={arText} onChange={e=>setArText(e.target.value)} />
            <p className="text-xs text-zinc-500 mt-1">Helius –≤–∫–ª—é—á–∞–µ—Ç —Ç–∞–π–º–µ—Ä –∏ –∂–¥—ë—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è <b>–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö</b> –º–∏–Ω—Ç–æ–≤ —Å —ç—Ç–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏.</p>
          </div>
          <div>
            <Label>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</Label>
            <div className="text-xs text-zinc-500">–ù–æ–≤—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ –≤ ¬´–ê–ª–µ—Ä—Ç—ã¬ª.</div>
          </div>
        </div>
        <div className="mt-4 rounded-lg border border-zinc-800">
          <table className="w-full text-sm">
            <thead className="bg-zinc-900/60"><tr><th className="px-3 py-2">–ù–∞–∑–≤–∞–Ω–∏–µ</th><th className="px-3 py-2">–ú–∏–Ω—Ç</th><th className="px-3 py-2">–ö–æ–º–∞–Ω–¥–∞</th><th className="px-3 py-2">–ò—Å—Ç–æ—á–Ω–∏–∫</th><th className="px-3 py-2">–û—Ä–∏–≥.</th><th className="px-3 py-2">–î–∞—Ç–∞/–≤—Ä–µ–º—è</th></tr></thead>
            <tbody>
              {arRows.length? arRows.map((r)=> (
                <tr key={r.id} className="border-t border-zinc-800/60"><td className="px-3 py-2">{r.name}</td><td className="px-3 py-2 font-mono">{r.mint}</td><td className="px-3 py-2">{r.team}</td><td className="px-3 py-2">{r.source}</td><td className="px-3 py-2">{r.original?"yes":"no"}</td><td className="px-3 py-2">{r.ts}</td></tr>
              )): <tr><td className="px-3 py-3 text-center text-zinc-500" colSpan={6}>–ü—É—Å—Ç–æ</td></tr>}
            </tbody>
          </table>
        </div>
      </CardContent>
    </Card>
  );

  const ChartWithOverlays = (
    <div className="relative w-full h-[380px] rounded-xl border border-zinc-800 bg-zinc-900/40">
      <ResponsiveContainer width="100%" height="100%">
        <LineChart data={chartData} margin={{left:12,right:12,top:8,bottom:8}}>
          <CartesianGrid stroke="#222" />
          <XAxis dataKey="i" hide/>
          <YAxis domain={["dataMin","dataMax"]} width={50} stroke="#666"/>
          <Tooltip formatter={(v)=>v} labelFormatter={(l)=>`t=${l}`} contentStyle={{background:"#0a0a0a", border:"1px solid #3f3f46"}}/>
          <Line type="monotone" dataKey="v" dot={false} strokeWidth={2}/>
          {overlayEvents.map(e=> (
            <ReferenceArea key={e.id} x1={e.i-0.5} x2={e.i+0.5} y1={0} y2={99999} fill={e.color} fillOpacity={0.18} stroke={e.color} strokeOpacity={0.4} />
          ))}
        </LineChart>
      </ResponsiveContainer>
      <div className="absolute top-2 right-2 flex gap-2 text-[11px]">
        <Badge tone="ok">–∑–µ–ª—ë–Ω—ã–π = BUY</Badge>
        <Badge tone="bad">–∫—Ä–∞—Å–Ω—ã–π = SELL</Badge>
        <Badge className="bg-sky-700 text-white">—Å–∏–Ω–∏–π = WHALE</Badge>
        <Badge className="bg-amber-600 text-white">–∂—ë–ª—Ç—ã–π = HYPE</Badge>
      </div>
    </div>
  );

  const Tradeview = (
    <Card>
      <CardHeader>
        <CardTitle>Tradeview ‚Äî –∏–Ω—Ñ–æ-—Ä–µ–∂–∏–º (–≥—Ä–∞—Ñ–∏–∫ ¬´–∫–∞–∫ Birdeye¬ª, –Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ)</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="grid grid-cols-1 md:grid-cols-5 gap-3 items-center">
          <div className="md:col-span-2 flex items-center gap-2">
            <Input placeholder="–≤—Å—Ç–∞–≤—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç" value={tradeQuery} onChange={e=>setTradeQuery(e.target.value)} />
            <Button onClick={onSignals}>–°–∏–≥–Ω–∞–ª—ã</Button>
          </div>
          <div className="flex items-center gap-2 text-sm"><Label>Whale SOL –æ—Ç</Label><NumberInput className="w-20" min={1} max={whaleMax} value={whaleMin} onChange={e=>setWhaleMin(Math.max(1, Math.min(parseInt(e.target.value||"3"), whaleMax)))}/></div>
          <div className="flex items-center gap-2 text-sm"><Label>–¥–æ</Label><NumberInput className="w-20" min={whaleMin} max={100} value={whaleMax} onChange={e=>setWhaleMax(Math.max(whaleMin, parseInt(e.target.value||"19")))}/></div>
          <div className="flex items-center gap-2 text-sm"><Label>–û–∫–Ω–æ (—Å–µ–∫)</Label><NumberInput className="w-20" min={1} max={60} value={winSec} onChange={e=>setWinSec(parseInt(e.target.value||"10"))}/></div>
          <div className="flex items-center gap-2 text-sm"><input type="checkbox" checked={aggr} onChange={e=>setAggr(e.target.checked)}/><span>Aggressive</span></div>
        </div>

        <div className="mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4">
          <div className="lg:col-span-2">
            {ChartWithOverlays}
            <div className="mt-3 grid grid-cols-2 gap-3 text-xs">
              <div className="rounded-lg border border-zinc-800 p-3">
                <div className="text-zinc-400 mb-1">–ú–µ—Ç—Ä–∏–∫–∏ —Ö–∞–π–ø–∞</div>
                <div>Twitter: 1h <b>{hypeMetrics.tw1h}</b> ¬∑ 3h <b>{hypeMetrics.tw3h}</b></div>
                <div>Telegram: 1h <b>{hypeMetrics.tg1h}</b> ¬∑ 3h <b>{hypeMetrics.tg3h}</b></div>
              </div>
              <div className="rounded-lg border border-zinc-800 p-3">
                <div className="text-–∑inc-400 mb-1">–ü—Ä–∏—á–∏–Ω—ã (–ø–æ—á–µ–º—É —Ç–∞–∫)</div>
                <ul className="list-disc ml-5 leading-6">
                  {reasons.length? reasons.map((t,i)=>(<li key={i}>{t}</li>)) : <li>–ù–∞–∂–º–∏—Ç–µ ¬´–°–∏–≥–Ω–∞–ª—ã¬ª, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑.</li>}
                </ul>
              </div>
            </div>
          </div>

          <div className="space-y-3">
            <Card>
              <CardHeader><CardTitle>–°–∏–≥–Ω–∞–ª—ã</CardTitle></CardHeader>
              <CardContent className="text-sm space-y-2">
                {overlayEvents.slice(-10).reverse().map(e=> (
                  <div key={e.id} className="flex items-center gap-2"><span className="inline-block w-2 h-2 rounded-full" style={{background:e.color}}></span><span>{e.type}</span><Badge className="ml-auto">t‚âà{e.i}</Badge></div>
                ))}
                {!overlayEvents.length && <div className="text-zinc-500">–°–∏–≥–Ω–∞–ª–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>}
              </CardContent>
            </Card>
            <Card>
              <CardHeader><CardTitle>–ü–æ—Ç–æ–∫–∏</CardTitle></CardHeader>
              <CardContent className="text-sm space-y-2">
                <div>Whale IN/OUT ¬∑ BUY/SELL ¬∑ Risk</div>
                <div className="text-xs text-zinc-500">(—Ä–µ–∞–ª—å–Ω–æ: Helius swaps/liquidity + RugCheck + DexScreener/Birdeye)</div>
              </CardContent>
            </Card>
            <Card>
              <CardHeader><CardTitle>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–Ω–∞–Ω–∏–π</CardTitle></CardHeader>
              <CardContent className="text-sm space-y-2">
                <div className="grid grid-cols-1 gap-2">
                  <label className="text-xs text-zinc-400">–ö–Ω–∏–≥–∏ <Input type="file" multiple /></label>
                  <label className="text-xs text-zinc-400">–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ <Input type="file" multiple /></label>
                  <label className="text-xs text-zinc-400">–¢–æ–Ω–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ <Input type="file" multiple /></label>
                  <label className="text-xs text-zinc-400">–ì—Ä–∞—Ñ–∏–∫–∏/—Ñ–æ—Ç–æ <Input type="file" multiple /></label>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      </CardContent>
    </Card>
  );

  const Helius = (
    <Card>
      <CardHeader right={<div className="flex items-center gap-2"><Button onClick={startHel}>–°—Ç–∞—Ä—Ç</Button><Button variant="ghost" onClick={stopHel}>–°—Ç–æ–ø</Button>{helRunning? <Badge tone="ok">—Ä–∞–±–æ—Ç–∞–µ—Ç</Badge>: <Badge tone="bad">—Å—Ç–æ–ø</Badge>}</div>}>
        <CardTitle>Helius –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–ø—Ä–æ—à–µ–¥—à–∏–µ 5‚Äì9 –ø—Ä–æ–≤–µ—Ä–æ–∫)</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="rounded-lg border border-–∑inc-800 overflow-hidden">
          <table className="w-full text-sm">
            <thead className="bg-zinc-900/60"><tr>
              <th className="px-3 py-2">–ë–µ–∑–æ–ø.</th><th className="px-3 py-2">–û—Ä–∏–≥.</th><th className="px-3 py-2">Twitter</th><th className="px-3 py-2">–ö–æ–º–∞–Ω–¥–∞</th><th className="px-3 py-2">–ù–∞–∑–≤–∞–Ω–∏–µ</th><th className="px-3 py-2">–ú–∏–Ω—Ç</th><th className="px-3 py-2">SOL</th><th className="px-3 py-2">–°–∫–∞—á–∞—Ç—å</th>
            </tr></thead>
            <tbody>
              {helRows.length? helRows.map(r=> (
                <tr key={r.id} className="border-t border-zinc-800/60">
                  <td className="px-3 py-2">{r.safe?"‚úì":"‚úó"}</td>
                  <td className="px-3 py-2">{r.original?"‚úì":""}</td>
                  <td className="px-3 py-2">{r.hasTw?"‚úì":""}</td>
                  <td className="px-3 py-2">{r.team}</td>
                  <td className="px-3 py-2">{r.name}</td>
                  <td className="px-3 py-2 font-mono">{r.mint}</td>
                  <td className="px-3 py-2">{r.sol}</td>
                  <td className="px-3 py-2"><Button size="sm" onClick={()=>download(`${r.name}_mint.txt`, r.mint, 'text/plain')}>‚¨á</Button></td>
                </tr>
              )): <tr><td className="px-3 py-3 text-center text-zinc-500" colSpan={8}>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ‚Äî –Ω–∞–∂–º–∏—Ç–µ –°—Ç–∞—Ä—Ç</td></tr>}
            </tbody>
          </table>
        </div>
      </CardContent>
    </Card>
  );

  const CEXRadar = (
    <Card>
      <CardHeader right={<div className="flex items-center gap-2"><Input placeholder="–∫–æ–Ω—Ç—Ä–∞–∫—Ç –∏–ª–∏ —Ç–∏–∫–µ—Ä" value={cexQuery} onChange={e=>setCexQuery(e.target.value)} className="w-60"/><Button onClick={()=>{ setCexRunning(true); cexSearch(); }}>–°—Ç–∞—Ä—Ç</Button><Button variant="ghost" onClick={()=>{ setCexRunning(false); setCexRows([]); }}>–°—Ç–æ–ø</Button></div>}>
        <CardTitle>CEX Radar ‚Äî –ø–µ—Ä–≤—ã–µ –ª–∏—Å—Ç–∏–Ω–∫–∏</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="rounded-lg border border-zinc-800 overflow-hidden">
          <table className="w-full text-sm">
            <thead className="bg-zinc-900/60"><tr>
              <th className="px-3 py-2">–ë–∏—Ä–∂–∞</th><th className="px-3 py-2">–î–∞—Ç–∞</th><th className="px-3 py-2">–í—Ä–µ–º—è</th><th className="px-3 py-2">–ö–æ–º–∞–Ω–¥–∞</th><th className="px-3 py-2">–û—Ç–∫—Ä—ã—Ç—å</th>
            </tr></thead>
            <tbody>
              {cexRows.length? cexRows.map((r,i)=> (
                <tr key={i} className="border-t border-zinc-800/60">
                  <td className="px-3 py-2">{r.exchange}</td>
                  <td className="px-3 py-2">{r.date}</td>
                  <td className="px-3 py-2">{r.time}</td>
                  <td className="px-3 py-2">{r.team}</td>
                  <td className="px-3 py-2"><a className="text-sky-300" href={r.url} target="_blank" rel="noreferrer">Birdeye</a></td>
                </tr>
              )): <tr><td className="px-3 py-3 text-center text-zinc-500" colSpan={5}>–ù–∞–∂–º–∏—Ç–µ –°—Ç–∞—Ä—Ç –∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ/–∫–æ–Ω—Ç—Ä–∞–∫—Ç</td></tr>}
            </tbody>
          </table>
        </div>
      </CardContent>
    </Card>
  );

  const Learn = (
    <Card>
      <CardHeader><CardTitle>–£—á–∏—Ç—å—Å—è (Knowledge)</CardTitle></CardHeader>
      <CardContent>
        <div className="grid md:grid-cols-2 gap-4">
          <div className="space-y-2">
            <Label>–ö–Ω–∏–≥–∏</Label>
            <Input type="file" multiple />
            <Label>–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞</Label>
            <Input type="file" multiple />
          </div>
          <div className="space-y-2">
            <Label>–¢–æ–Ω–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</Label>
            <Input type="file" multiple />
            <Label>–ì—Ä–∞—Ñ–∏–∫–∏/—Ñ–æ—Ç–æ</Label>
            <Input type="file" multiple />
          </div>
        </div>
      </CardContent>
    </Card>
  );

  const Chat = (
    <Card>
      <CardHeader><CardTitle>–ß–∞—Ç —Å –ò–ò (–¥–µ–º–æ)</CardTitle></CardHeader>
      <CardContent>
        <div className="max-h-64 overflow-auto rounded-lg border border-zinc-800 p-2 text-sm bg-zinc-900/40">
          <div className="text-zinc-500">–ü—É—Å—Ç–æ</div>
        </div>
        <div className="mt-2 flex gap-2">
          <Input id="ask" placeholder="–°–ø—Ä–æ—Å–∏—Ç—å —É –ò–ò‚Ä¶"/>
          <Button onClick={()=>{ const el=document.getElementById("ask"); const v=el&&el.value; if(v){ setAlerts(a=>[{ts:new Date().toISOString(), type:"ai", asset:"chat", msg:"–ò–ò –æ—Ç–≤–µ—Ç–∏–ª (–¥–µ–º–æ)"}, ...a]); el.value=""; } }}>–°–ø—Ä–æ—Å–∏—Ç—å</Button>
        </div>
      </CardContent>
    </Card>
  );

  const Logs = (
    <Card>
      <CardHeader right={<Badge tone={unread?"warn":""}>üîî {unread}</Badge>}><CardTitle>–õ–æ–≥–∏</CardTitle></CardHeader>
      <CardContent>
        <div className="text-xs text-zinc-300 whitespace-pre-wrap min-h-[120px]">{logs.map(l=>`[${new Date(l.ts).toLocaleTimeString()}] ${l.msg}`).join("\n")||"–ü–æ–∫–∞ –ø—É—Å—Ç–æ"}</div>
      </CardContent>
    </Card>
  );

  // ======= SELFTESTS =======
  const [tests, setTests] = useState([]);
  useEffect(()=>{
    const T = []; const A=(name, cond, details="")=>T.push({name, ok:!!cond, details});
    // parseTickers
    const ticks = parseTickers(" $TRUMP, PEPE;DOGE\nDOGE\n$WATER  ");
    A("parseTickers unique+$-strip", JSON.stringify(ticks) === JSON.stringify(["TRUMP","PEPE","DOGE","WATER"]), JSON.stringify(ticks));
    // uniqueHypeWords
    const uh = uniqueHypeWords([{word:"A",author:"@x",link:"/",detectedAt:"2025-09-01 10:00",source:"Twitter"},{word:"a",author:"@y",link:"/2",detectedAt:"2025-09-01 11:00",source:"Telegram"}]);
    A("uniqueHypeWords picks latest", uh.length===1 && uh[0].author==='@y');
    // genSeries
    const s = genSeries(10, 1); A("genSeries len=10", s.length===10 && typeof s[0].v === "number");
    // CSV join (–∏–∑ –ø—Ä–æ—à–ª—ã—Ö —Ç–µ—Å—Ç–æ–≤)
    const sample = [{word:"A", detectedAt:"t", author:"b", contract:"c", summary:"x\ny"}];
    const csv = sample.map(r=> [r.word,r.detectedAt,r.author,r.contract??"", (r.summary??"").replace(/\n/g," ")].map(x=>`"${String(x).replace(/"/g,'""')}"`).join(",")).join("\n");
    A("CSV flattens newlines", csv.includes('"x y"'));
    // –î–æ–ø. —Ç–µ—Å—Ç: CSV –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞
    A("CSV one row", csv.split("\n").length===1);
    setTests(T);
  },[]);
  const SelfTests = (
    <Card>
      <CardHeader><CardTitle>Selftests</CardTitle></CardHeader>
      <CardContent>
        <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-2">
          {tests.map((t,i)=>(
            <div key={i} className="flex items-center gap-2 rounded-lg border border-zinc-800 bg-zinc-900/50 px-3 py-2 text-sm">
              <Badge tone={t.ok?"ok":"bad"}>{t.ok?"PASS":"FAIL"}</Badge>
              <span>{t.name}</span>
              {t.details? <code className="text-zinc-400 truncate">{String(t.details)}</code>: null}
            </div>
          ))}
          {!tests.length && <div className="text-zinc-500">Running‚Ä¶</div>}
        </div>
      </CardContent>
    </Card>
  );

  // ======= RENDER =======
  return (
    <div className="min-h-screen w-full bg-black text-white">
      <div className="mx-auto max-w-[1400px] px-6 py-6">
        {/* Header */}
        <div className="flex items-center justify-between">
          <div>
            <h1 className="text-xl font-semibold">Super Parser AI ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</h1>
            <p className="text-xs text-zinc-400">Dark UI ‚Ä¢ Groq ¬∑ Apify ¬∑ Helius ¬∑ QuickNode ¬∑ Pumpfun ¬∑ Nansen</p>
          </div>
          <div className="flex items-center gap-2">
            <Button className="bg-emerald-600" onClick={()=>setRunning(!running)}>{running?"–°—Ç–æ–ø":"–°—Ç–∞—Ä—Ç"}</Button>
            <Button onClick={()=>download("signals.json", JSON.stringify(rows,null,2), "application/json")}>JSON</Button>
            <Button onClick={()=>{ const headers=["–ù–∞–∑–≤–∞–Ω–∏–µ/—Å–ª–æ–≤–æ","–î–∞—Ç–∞/–≤—Ä–µ–º—è","–ê–≤—Ç–æ—Ä","–ö–æ–Ω—Ç—Ä–∞–∫—Ç","–†–µ–∑—é–º–µ"].join(","); const csv = rows.map(r=> [r.word,r.detectedAt,r.author,r.contract??"", (r.summary??"").replace(/\n/g," ")].map(x=>`"${String(x).replace(/"/g,'""')}"`).join(",")).join("\n"); download("signals.csv", headers+"\n"+csv, "text/csv;charset=utf-8"); }}>CSV</Button>
          </div>
        </div>

        <Tabs value={tab} onValueChange={setTab} className="mt-6">
          <TabsList>
            <TabsTrigger value="signals">–°–∏–≥–Ω–∞–ª—ã</TabsTrigger>
            <TabsTrigger value="accounts">–ê–∫–∫–∞—É–Ω—Ç—ã</TabsTrigger>
            <TabsTrigger value="heliusAR">Helius AR</TabsTrigger>
            <TabsTrigger value="tradeview">Tradeview</TabsTrigger>
            <TabsTrigger value="filters">–§–∏–ª—å—Ç—Ä—ã</TabsTrigger>
            <TabsTrigger value="alerts">–ê–ª–µ—Ä—Ç—ã</TabsTrigger>
            <TabsTrigger value="helius">Helius</TabsTrigger>
            <TabsTrigger value="cexradar">CEX Radar</TabsTrigger>
            <TabsTrigger value="learn">–£—á–∏—Ç—å—Å—è</TabsTrigger>
            <TabsTrigger value="chat">–ß–∞—Ç</TabsTrigger>
            <TabsTrigger value="logs">–õ–æ–≥–∏</TabsTrigger>
          </TabsList>

          <TabsContent value="signals">{Signals}</TabsContent>
          <TabsContent value="accounts">{Accounts}</TabsContent>
          <TabsContent value="heliusAR">{HeliusAR}</TabsContent>
          <TabsContent value="tradeview">{Tradeview}</TabsContent>
          <TabsContent value="filters">{/* –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */}</TabsContent>
          <TabsContent value="alerts">{/* –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∞–ª–µ—Ä—Ç—ã –∏–∑ –¥—Ä—É–≥–∏—Ö –≤–∫–ª–∞–¥–æ–∫) */}</TabsContent>
          <TabsContent value="helius">{Helius}</TabsContent>
          <TabsContent value="cexradar">{CEXRadar}</TabsContent>
          <TabsContent value="learn">{Learn}</TabsContent>
          <TabsContent value="chat">{Chat}</TabsContent>
          <TabsContent value="logs">{Logs}</TabsContent>
        </Tabs>

        <div className="mt-6">{SelfTests}</div>
      </div>
    </div>
  );
}
